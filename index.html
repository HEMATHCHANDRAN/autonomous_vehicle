<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Rover Control - ESP32 Autonomous v2.0</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü§ñ</text></svg>">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <i class="fas fa-robot"></i>
                <h1>ROVER<span>CONTROL</span> <small>v2.0</small></h1>
            </div>
            <div class="connection-status" id="connectionStatus">
                <span class="status-dot"></span>
                <span class="status-text" id="statusText">Disconnected</span>
            </div>
        </header>

        <!-- Main Control Panel -->
        <main class="control-panel">
            <!-- Live Status Dashboard -->
            <div class="status-card">
                <h2><i class="fas fa-satellite-dish"></i> Real-Time Telemetry</h2>
                <div class="status-grid">
                    <div class="status-item">
                        <span class="label"><i class="fas fa-wifi"></i> WiFi Strength</span>
                        <span class="value" id="wifiStrength">--</span>
                    </div>
                    <div class="status-item">
                        <span class="label"><i class="fas fa-network-wired"></i> Rover IP</span>
                        <span class="value" id="roverIP">--</span>
                    </div>
                    <div class="status-item">
                        <span class="label"><i class="fas fa-clock"></i> Uptime</span>
                        <span class="value" id="roverUptime">--</span>
                    </div>
                    <div class="status-item">
                        <span class="label"><i class="fas fa-running"></i> Movement</span>
                        <span class="value" id="roverMovement">Stopped</span>
                    </div>
                    <div class="status-item">
                        <span class="label"><i class="fas fa-tachometer-alt"></i> Speed</span>
                        <span class="value" id="roverSpeed">--</span>
                    </div>
                    <div class="status-item">
                        <span class="label"><i class="fas fa-lightbulb"></i> LED State</span>
                        <span class="value" id="ledState">--</span>
                    </div>
                    <div class="status-item">
                        <span class="label"><i class="fas fa-blink"></i> LED Blinking</span>
                        <span class="value" id="ledBlinking">--</span>
                    </div>
                    <div class="status-item">
                        <span class="label"><i class="fas fa-server"></i> Broker</span>
                        <span class="value" id="brokerStatus">Disconnected</span>
                    </div>
                </div>
                
                <!-- Speed Control -->
                <div class="speed-control">
                    <label for="speedSlider"><i class="fas fa-sliders-h"></i> Motor Speed: <span id="speedValue">180</span>/255</label>
                    <input type="range" id="speedSlider" min="50" max="255" value="180" class="slider">
                    <button id="btnSetSpeed" class="btn-small"><i class="fas fa-bolt"></i> Set Speed</button>
                </div>
            </div>

            <!-- Control Pad -->
            <div class="control-card">
                <h2><i class="fas fa-gamepad"></i> Manual Control</h2>
                <p class="control-hint">Click buttons or use arrow keys + Spacebar</p>
                
                <div class="control-grid">
                    <!-- Forward -->
                    <div class="control-row">
                        <button class="control-btn btn-forward" id="btnForward" data-command="forward">
                            <i class="fas fa-arrow-up"></i>
                            <span>FORWARD</span>
                            <div class="key-hint">‚Üë Arrow Up</div>
                        </button>
                    </div>
                    
                    <!-- Left, Stop, Right -->
                    <div class="control-row">
                        <button class="control-btn btn-left" id="btnLeft" data-command="left">
                            <i class="fas fa-arrow-left"></i>
                            <span>LEFT</span>
                            <div class="key-hint">‚Üê Arrow Left</div>
                        </button>
                        
                        <button class="control-btn btn-stop" id="btnStop" data-command="stop">
                            <i class="fas fa-stop"></i>
                            <span>EMERGENCY STOP</span>
                            <div class="key-hint">Spacebar</div>
                        </button>
                        
                        <button class="control-btn btn-right" id="btnRight" data-command="right">
                            <i class="fas fa-arrow-right"></i>
                            <span>RIGHT</span>
                            <div class="key-hint">‚Üí Arrow Right</div>
                        </button>
                    </div>
                    
                    <!-- Backward -->
                    <div class="control-row">
                        <button class="control-btn btn-backward" id="btnBackward" data-command="backward">
                            <i class="fas fa-arrow-down"></i>
                            <span>BACKWARD</span>
                            <div class="key-hint">‚Üì Arrow Down</div>
                        </button>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="quick-actions">
                    <button class="btn-action" id="btnAutoStop" data-command="stop">
                        <i class="fas fa-hand-paper"></i> Quick Stop
                    </button>
                    <button class="btn-action" id="btnGetStatus" data-command="status">
                        <i class="fas fa-sync-alt"></i> Refresh Status
                    </button>
                </div>
            </div>

            <!-- LED Control Panel -->
            <div class="led-control-card">
                <h2><i class="fas fa-lightbulb"></i> ESP32 LED Control</h2>
                <p class="led-description">Test connection & control the built-in LED on ESP32</p>
                
                <div class="led-control-grid">
                    <!-- LED Status -->
                    <div class="led-status">
                        <div class="led-indicator" id="ledIndicator">
                            <div class="led-glow"></div>
                            <div class="led-base"></div>
                        </div>
                        <div class="led-info">
                            <h3>LED Status</h3>
                            <p>State: <span id="ledStatusText">Unknown</span></p>
                            <p>Blinking: <span id="ledBlinkStatus">No</span></p>
                        </div>
                    </div>
                    
                    <!-- LED Control Buttons -->
                    <div class="led-controls">
                        <h3><i class="fas fa-toggle-on"></i> Basic Control</h3>
                        <div class="led-button-group">
                            <button class="led-btn led-btn-on" id="btnLedOn">
                                <i class="fas fa-power-off"></i> Turn ON
                            </button>
                            <button class="led-btn led-btn-off" id="btnLedOff">
                                <i class="fas fa-times-circle"></i> Turn OFF
                            </button>
                            <button class="led-btn led-btn-toggle" id="btnLedToggle">
                                <i class="fas fa-random"></i> Toggle
                            </button>
                        </div>
                    </div>
                    
                    <!-- LED Blink Control -->
                    <div class="led-blink-control">
                        <h3><i class="fas fa-blink"></i> Blink Control</h3>
                        <div class="blink-control-group">
                            <button class="led-btn led-btn-blink" id="btnLedBlink">
                                <i class="fas fa-play-circle"></i> Start Blink
                            </button>
                            <button class="led-btn led-btn-blink-stop" id="btnLedBlinkStop">
                                <i class="fas fa-stop-circle"></i> Stop Blink
                            </button>
                        </div>
                        
                        <div class="blink-speed-control">
                            <label for="blinkSpeedSlider">
                                <i class="fas fa-tachometer-alt"></i> Blink Speed: 
                                <span id="blinkSpeedValue">500</span>ms
                            </label>
                            <input type="range" id="blinkSpeedSlider" min="100" max="2000" value="500" class="slider">
                            <button class="btn-small" id="btnSetBlinkSpeed">
                                <i class="fas fa-cog"></i> Set Interval
                            </button>
                        </div>
                    </div>
                    
                    <!-- LED Test Sequence -->
                    <div class="led-test-sequence">
                        <h3><i class="fas fa-vial"></i> Test Sequence</h3>
                        <p>Run connection test patterns</p>
                        <div class="test-buttons">
                            <button class="test-btn" id="btnTestConnection">
                                <i class="fas fa-plug"></i> Connection Test
                            </button>
                            <button class="test-btn" id="btnTestPattern">
                                <i class="fas fa-wave-square"></i> Pattern Test
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Connection & Settings -->
            <div class="settings-card">
                <h2><i class="fas fa-cogs"></i> Connection Settings</h2>
                
                <div class="settings-group">
                    <!-- Rover ID -->
                    <div class="input-group">
                        <label for="roverId"><i class="fas fa-fingerprint"></i> Rover ID</label>
                        <input type="text" id="roverId" value="ROVER_001" placeholder="Enter your rover's unique ID">
                        <small>Must match the ID in ESP32 code</small>
                    </div>
                    
                    <!-- Connection Info -->
                    <div class="info-box">
                        <h3><i class="fas fa-info-circle"></i> Connection Details</h3>
                        <p><strong>Broker:</strong> Your HiveMQ Cloud</p>
                        <p><strong>WebSocket:</strong> wss://5fe0dce1f05b48e2a680b77941ce0130.s1.eu.hivemq.cloud:8884/mqtt</p>
                        <p><strong>LED Topic:</strong> rover/led/ROVER_001</p>
                    </div>
                    
                    <!-- Connection Buttons -->
                    <div class="button-group">
                        <button class="btn-connect" id="btnConnect">
                            <i class="fas fa-plug"></i> Connect to Rover
                        </button>
                        <button class="btn-disconnect" id="btnDisconnect" disabled>
                            <i class="fas fa-unlink"></i> Disconnect
                        </button>
                        <button class="btn-restart" id="btnRestart" disabled>
                            <i class="fas fa-redo"></i> Restart ESP32
                        </button>
                    </div>
                    
                    <!-- Connection Log -->
                    <div class="log-box">
                        <h3><i class="fas fa-history"></i> Connection Log</h3>
                        <div class="log-content" id="connectionLog">
                            <div class="log-entry">System initialized. Ready to connect.</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>
                <i class="fas fa-globe"></i> 
                <strong>Global Rover Control v2.0</strong> | 
                ESP32 + HiveMQ Cloud | 
                Real-Time Telemetry + LED Control | 
                <span id="lastUpdate">Last update: --</span>
            </p>
            <p class="connection-info" id="mqttInfo">
                <i class="fas fa-cloud"></i> Broker: 5fe0dce1f05b48e2a680b77941ce0130.s1.eu.hivemq.cloud:8884
            </p>
        </footer>
    </div>

    <!-- MQTT Library -->
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
    <!-- Main Script -->
    <script src="script.js"></script>
</body>
</html>
